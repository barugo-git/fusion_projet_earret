{% extends 'base.html.twig' %}

{% block title %}Dossier index{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title mb-0">Dossiers en attente d'ouverture</h4>
                </div><!-- end card header -->

                <div class="card-body">
                    <div id="customerList">

                        <div class="data_table table-card mt-3 mb-1">
                            {% if dossiers|length > 0 %}
                                <table class="table table-responsive align-middle" id="customerTable">
                                    <thead class="table-light">
                                    <tr>
                                        <th class="sort"></th>
                                        <th class="sort" data-sort="customer_name">N°enre</th>
                                        <th class="sort" data-sort="email">Date affectation</th>
                                        <th class="sort" data-sort="phone">Réquerant</th>
                                        <th class="sort" data-sort="date">Defendeur</th>

{#                                        <th class="sort" data-sort="date">Etat du dossier</th>#}
                                        <th class="sort" data-sort="action">Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for dossier in dossiers %}
                                        <tr>
                                            <td>{{ loop.index }}</td>
                                            <td class="customer_name">{{ dossier.referenceDossier }}</td>
{#                                            {{ dump(dossier) }}#}
                                            <td class="email">{{ dossier.dateAutorisation ? dossier.dateAutorisation|date('d-m-Y') : '' }}</td>

                                            <td class="email">

                                                {% if dossier.requerant.type =='moral' %}

                                                    {{ dossier.requerant.intitule }}
                                                {% else %}

                                                    {{ dossier.requerant.nom ~" "~ dossier.requerant.prenoms }}
                                                {% endif %}

                                            </td>

                                            <td class="email">
                                                {% if dossier.defendeur.type =='moral' %}
                                                    {{ dossier.defendeur.intitule }}

                                                {% else %}
                                                    {{ dossier.defendeur.nom ~" "~ dossier.defendeur.prenoms }}
                                                {% endif %}
                                            </td>
{#                                            <td> {{ dossier.affecterSection.conseillerRapporteur.UserInformations }} </td>#}
{#                                            <td> {{ dossier.etatDossier }}</td>#}

                                            <td>
                                                <button class="btn btn-soft-secondary btn-sm dropdown" type="button"
                                                        data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-fill align-middle"></i>
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end" style="">
                                                    <li>
                                                        <a href="{{ path('admin_dossier_details',{'id':dossier.id}) }}" class="dropdown-item"
                                                           title="Voir les détails de la requete">
                                                            <i class="ri-eye-fill"></i> Détails du dossier
                                                        </a>
                                                    </li>
                                                    <li>
                                                        <a href="{{ path('app_dossier_open',{'id':dossier.id}) }}" class="dropdown-item"
                                                           title="Voir les détails de la requete">
                                                            <i class="ri-eye-fill"></i> Ouvrir le dossier
                                                        </a>
                                                    </li>
                                                    {% if is_granted("ROLE_GREFFIER_EN_CHEF") %}
                                                    <li>
                                                        <a href="{{ path('admin_transfert_dossier_user',{'id':dossier.id}) }}" class="dropdown-item"
                                                           title="Voir les détails de la requete">
                                                            <i class="ri-eye-fill"></i> Transferer à un autre greffier
                                                        </a>
                                                    </li>
                                                    {% endif %}
                                                </ul>



                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            {% else %}
                                <div class="noresult">
                                    <div class="text-center">
                                        <lord-icon src="https://cdn.lordicon.com/msoeawqm.json" trigger="loop"
                                                   colors="primary:#121331,secondary:#08a88a"
                                                   style="width:75px;height:75px">
                                        </lord-icon>
                                        <h5 class="mt-2">Aucunes données pour l'instant</h5>
                                        {#                                       <p class="text-muted mb-0">We've searched more than 150+ Orders We did not find any#}
                                        {#                                           orders for you search.</p>#}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}
