{% extends 'base.html.twig' %}

{% block title %}Dossier index{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-header">
                    <h4 class="card-title mb-0">Liste des dossiers ouverts</h4>
                </div><!-- end card header -->

                <div class="card-body">
                    <div id="customerList">

                        <div class="data_table table-card mt-3 mb-1">
                            {% if dossiers|length > 0 %}
                                <table class="table table-responsive align-middle" id="customerTable">
                                    <thead class="table-light">
                                    <tr>
                                        <th class="sort"></th>
                                        <th class="sort" data-sort="customer_name">N°enre</th>
                                        <th class="sort" data-sort="email">Date affectation</th>
                                        <th class="sort" data-sort="phone">Réquerant</th>
                                        <th class="sort" data-sort="date">Defendeur</th>
                                        <th class="sort" data-sort="date">Conseil Rapporteur</th>
{#                                        <th class="sort" data-sort="date">Etat du dossier</th>#}
                                        <th class="sort" data-sort="action">Action</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for dossier in dossiers %}
                                        <tr>
                                            <td>{{ loop.index }}</td>
                                            <td class="customer_name">{{ dossier.referenceDossier }}</td>
{#                                            {{ dump(dossier) }}#}
                                            <td class="email">{{ dossier.affecterSection.dateAffectation ? dossier.affecterSection.dateAffectation|date('d-m-Y') : '' }}</td>

                                            <td class="email">

                                                {% if dossier.requerant.type =='moral' %}

                                                    {{ dossier.requerant.intitule }}
                                                {% else %}

                                                    {{ dossier.requerant.nom ~" "~ dossier.requerant.prenoms }}
                                                {% endif %}

                                            </td>

                                            <td class="email">
                                                {% if dossier.defendeur.type =='moral' %}
                                                    {{ dossier.defendeur.intitule }}

                                                {% else %}
                                                    {{ dossier.defendeur.nom ~" "~ dossier.defendeur.prenoms }}
                                                {% endif %}
                                            </td>
                                            <td> {{ dossier.affecterSection.conseillerRapporteur.UserInformations }} </td>
{#                                            <td> {{ dossier.etatDossier }}</td>#}

                                            <td>
                                                <button class="btn btn-soft-secondary btn-sm dropdown" type="button"
                                                        data-bs-toggle="dropdown" aria-expanded="false">
                                                    <i class="ri-more-fill align-middle"></i>
                                                </button>
                                                <ul class="dropdown-menu dropdown-menu-end" style="">
                                                    <li>
                                                        <a href="{{ path('admin_dossier_details',{'id':dossier.id}) }}" class="dropdown-item"
                                                           title="Voir les détails de la requete">
                                                            <i class="ri-eye-fill"></i> Détails du dossier
                                                        </a>

                                                    </li>
                                                    {% if dossier.mesuresInstructions %}
                                                    <li>
                                                        <a href="{{ path('greffier_mesures_instructions_dossier_list',{'id':dossier.id}) }}" class="dropdown-item" title="Voir les mesures d'instruction">
                                                            <i class="ri-stack-fill"></i> Les mesures d’instruction
                                                        </a>
                                                    </li>
                                                   {% endif %}
                                                    {% if dossier.consignation == false  %}
                                                    <li>
                                                        <a href="{{ path('greffier_dossier_consignation',{'id':dossier.id}) }}" class="dropdown-item">
                                                            <i class="ri-money-cny-circle-fill"></i>
                                                            Consignation</a>
                                                    </li>
                                                    {% endif %}
                                                    {% if dossier.consignation == true and dossier.memoireAmpliatif == false  %}
                                                    <li>
                                                        <a href="{{ path('greffier_dossier_memoire_ampliatif',{'id':dossier.id}) }}" class="dropdown-item">
                                                            <i class="ri-file-chart-2-line"></i>
                                                            Enregistre le memoire ampliatif</a>
                                                    </li>
                                                    {% endif %}
                                                    {% if dossier.memoireAmpliatif == true  and dossier.memoireEnDefense == false %}
                                                        <li>
                                                            <a href="" class="dropdown-item">
                                                                <i class="ri-file-3-fill"></i>
                                                                Enregistre le memoire en defense</a>
                                                        </li>
                                                    {% endif %}

{#                                                    <li>#}
{#                                                        <a href="{{ path('greffier_cloture_dossier',{'id':dossier.id}) }}" class="dropdown-item" title="Fermer le dossier">#}
{#                                                            <i class="ri-inbox-archive-line"></i> Clore le dossier#}
{#                                                        </a>#}

{#                                                    </li>#}


                                                    <li>
                                                        <a href="{{ path('greffier_mise_ajour',{'id':dossier.id})  }}" class="dropdown-item" title="Fermer le dossier">
                                                            <i class="ri-inbox-archive-line"></i> Statut Dossier
                                                        </a>

                                                    </li>
                                                    <li>
                                                        <a href="{{ path('dossier_historique',{'id':dossier.id})  }}" class="dropdown-item" title="Fermer le dossier">
                                                            <i class="ri-inbox-archive-line"></i> Historique Mise a jour
                                                        </a>

                                                    </li>


{#                                                    {% if  dossier.statut == "Dossier vidé : Arrêt disponible" %}#}
                                                    <li>
                                                        <a href="{{ path('greffier_arret_new',{'id':dossier.id})  }}" class="dropdown-item" title="Fermer le dossier">
                                                            <i class="ri-inbox-archive-line"></i> Publier l'arrêt
                                                        </a>

                                                    </li>
{#                                                    {% endif %}#}
                                                </ul>



                                            </td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            {% else %}
                                <div class="noresult">
                                    <div class="text-center">
                                        <lord-icon src="https://cdn.lordicon.com/msoeawqm.json" trigger="loop"
                                                   colors="primary:#121331,secondary:#08a88a"
                                                   style="width:75px;height:75px">
                                        </lord-icon>
                                        <h5 class="mt-2">Aucunes données pour l'instant</h5>
                                        {#                                       <p class="text-muted mb-0">We've searched more than 150+ Orders We did not find any#}
                                        {#                                           orders for you search.</p>#}
                                    </div>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


{% endblock %}
